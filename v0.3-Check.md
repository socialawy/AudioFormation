# v0.3 Release Readiness Check

## âœ… What's Solid (Ship-Ready)
| Area                     | Evidence                                                                                                   |
|--------------------------|------------------------------------------------------------------------------------------------------------|
| Core pipeline (Nodes 0â€“8) | All nodes have implementations                                                                            |
| Test suite                | 360/360, good coverage on critical paths                                                                   |
| Engine stack              | edge + gtts + xtts + elevenlabs, registry works                                                            |
| Mixer + ducking           | VAD primary, energy fallback, envelope smoothing                                                          |
| QC gates                 | Scanner (per-chunk) + Final (per-mix), both gated                                                          |
| M4B export               | export_project_m4b with ffmetadata + chapter markers                                                       |
| Server API               | 8 endpoints, background tasks for heavy ops                                                                |
| Arabic pipeline          | Diacritics, dialect matching, boundary splitting                                                          |

## ğŸ”´ Must Fix Before v0.3
1. Missing test coverage for new modules
```text
Source file              Test file              Gap
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
generate.py              (test_multispeaker.py) Partial â€” no direct unit tests
mix.py                   test_cli_mix.py        CLI only â€” no unit test for mix_project()
cloud.py                 (none)                 No tests
elevenlabs.py            (none)                 No tests
synthesis.py             (none)                 No tests
```
2. API surface is incomplete for full dashboard
```text
Endpoint                          Status
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€
GET    /projects                  âœ…
POST   /projects                  âœ…
GET    /projects/{id}             âœ…
PUT    /projects/{id}             âœ…
POST   /projects/{id}/ingest      âœ…
POST   /projects/{id}/generate    âœ…
POST   /projects/{id}/mix         âœ…
GET    /projects/{id}/status      âœ…
POST   /projects/{id}/validate    âŒ Missing
POST   /projects/{id}/process     âŒ Missing
POST   /projects/{id}/export      âŒ Missing
POST   /projects/{id}/compose     âŒ Missing
GET    /projects/{id}/qc          âŒ Missing
GET    /projects/{id}/audio/*     â“ How does dashboard serve audio files?
```
- Dashboard playback requires file serving. Is app.py mounting a static path to PROJECTS? Need to verify.

3. Schema may be stale

schemas/project.schema.json was created in Phase 1. Since then, added:

- fallback_scope, fallback_chain
- crossfade_overrides
- chapter_transition, chapter_transition_file
- mode field on chapters (single/multi)

If validation runs against the schema, new fields may fail.

4. asyncio.get_event_loop() deprecation warnings
ğŸŸ¡ Should Fix (Quality, Not Blocking)
```python
# Replace
asyncio.get_event_loop().run_until_complete(coro)
# With
asyncio.run(coro)
```

5. Mixer sample rate assumption
mixer.py passes audio to Silero VAD at voice_seg.frame_rate but Silero officially supports 8kHz and 16kHz. Edge-tts outputs 24kHz. This works (Silero is robust) but could cause subtle VAD threshold drift. Worth a comment or explicit resample.

6. Envelope edge artifacts

In _generate_envelope, after convolution:
```python
envelope[:edge_region] = 1.0
envelope[-edge_region:] = 1.0
```
This hard-sets edges to 1.0 after smoothing, creating a potential discontinuity at edge_region. Minor, but audible on headphones.

## Plan
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BLOCK 1: Test gaps (1 hour)                                 â”‚
â”‚  â”œâ”€â”€ test_generate.py â€” unit tests for generate_project()    â”‚
â”‚  â”œâ”€â”€ test_mix_unit.py â€” unit tests for mix_project()         â”‚
â”‚  â””â”€â”€ Stub tests for cloud.py / elevenlabs.py                 â”‚
â”‚  Target: ~380 tests                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BLOCK 2: Schema sync (15 min)                               â”‚
â”‚  â””â”€â”€ Update schemas/project.schema.json with all new fields  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BLOCK 3: API completeness (30 min)                          â”‚
â”‚  â”œâ”€â”€ POST validate, process, compose, export                 â”‚
â”‚  â”œâ”€â”€ GET qc (return latest reports)                          â”‚
â”‚  â”œâ”€â”€ GET audio file serving (if not already in app.py)       â”‚
â”‚  â””â”€â”€ Update test_server.py                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BLOCK 4: Minor fixes (15 min)                               â”‚
â”‚  â”œâ”€â”€ asyncio deprecation warnings                            â”‚
â”‚  â”œâ”€â”€ Mixer VAD sample rate comment                           â”‚
â”‚  â””â”€â”€ Envelope edge smoothing                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BLOCK 5: Release prep (15 min)                              â”‚
â”‚  â”œâ”€â”€ pyproject.toml â†’ version = "0.3.0"                      â”‚
â”‚  â”œâ”€â”€ CHANGELOG.md update                                     â”‚
â”‚  â””â”€â”€ Merge phase-3-server-mixer â†’ main                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Good news
Audio serving is already handled (/projects StaticFiles mount). CLI already has proper _run_async. Schema is completely stale though â€” generation properties not even found at top level.

Starting with Block 2 â†’ Block 3 â†’ Block 1 (dependency order: schema feeds validation, API feeds tests).

## Block 2: schemas/project.schema.json â€” Complete Replacement

## Block 3: API Route Additions

## Block 1: Test Files
tests/test_mix_unit.py


## Block 4: Minor Fixes
Fix 1: asyncio deprecation warning

Fix 2: Mixer VAD sample rate â€” comment only


